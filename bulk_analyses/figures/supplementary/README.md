## Supplementary Figures

This folder contains scripts for generating figures in the Supplementary Information section, including Supplementary Fig. 1 and 8-17 as well as all figures in Supplementary Text sections.

### Description of scripts

`SI_Figure1.Rmd` and `SI_Figure1.html`

Creates and saves bar plots of the per-sample coverage distributions from the HTAN and external cohorts.

Requires:
* coverage data tables generated by mosdepth (in this repo at `data/coverage/htan_fap_coverage_wgs.tsv` and `data/coverage/htan_fap_coverage_wes.tsv`)

Generates:
* all plots for SI Fig. 1

`SI_Figure8_17.ipynb`

Creates and saves smoothed VAF/ppVAF distribution plots for individual HTAN WGS and WES samples, classified by sample type and monoclonal/polyclonal classfications. Includes driver mutation frequencies and estimated clonal SNV counts during plotting.

Requires:
* filtered HTAN WGS and WES mafs (found in Zenodo dataset as `HTAN_WGS_filtered_ppVAFs.maf` and `HTAN_WES_filtered_ppVAFs.maf`)
* monoclonal/polyclonal classifications (HTAN calls in this repo at `data/clonal_count_estimation/clonal_SNVs_WES_WGS.csv`)

Generates:
* all plots for SI Fig. 8-17 as pdfs and jpgs

`SI_Text_1.ipynb`

Plots and saves all panels needed for figures in Supplementary Note 1. Calls the same functions needed for clonal/subclonal mutation classification and clonal SNV count estimation in the main text, stored in the shared code file `analysis/ppVAF_calculations/ppVAF_utils.py`.

Requires:
* filtered HTAN WGS and WES mafs (found in Zenodo dataset as `HTAN_WGS_filtered_ppVAFs.maf` and `HTAN_WES_filtered_ppVAFs.maf`)
* monoclonal/polyclonal classifications (HTAN calls in this repo at `data/clonal_count_estimation/clonal_SNVs_WES_WGS.csv`)
* pickled scATAC-seq purity distribution dictionary (in this repo at `data/scATACseq_annotations/scATAC_purities.p`)
* simulated clonal mutation mafs needed for clonal/subclonal classifier (in this repo at `data/clonal_count_estimation/simulated_clonal_WGS.csv` and `data/clonal_count_estimation/simulated_clonal_WES.csv`)

Generates:
* all plots for Fig. SN1* in Supplementary Note 1

`SI_Text_2.ipynb`

Plots and saves all panels needed for figures in Supplementary Note 2. 

Requires:
* filtered HTAN WGS and WES mafs (found in Zenodo dataset as `HTAN_WGS_filtered_ppVAFs.maf` and `HTAN_WES_filtered_ppVAFs.maf`)
* monoclonal/polyclonal classifications (HTAN calls in this repo at `data/clonal_count_estimation/clonal_SNVs_WES_WGS.csv`)
* pickled scATAC-seq purity distribution dictionary (in this repo at `data/scATACseq_annotations/scATAC_purities.p`)
* Sequenza and FACETS estimated sample purity tables (in this repo at `data/HTAN_WGS_facets_sequenza_purities.csv` and `data/HTAN_WES_facets_sequenza_purities.csv`)
* scATAC-seq cell fraction table (in this repo at `data/scATACseq_annotations/scATAC_celltype_fracs.csv`)
* clonal SNV counts and monoclonal/polyclonal classifications for simulated monoclonal WGS samples with specified sample purities (in this repo at `data/purity_sims/`)

Generates:
* all plots for Fig. SN2* in Supplementary Note 2
